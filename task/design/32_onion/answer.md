# 1

## 図解

![onion](https://user-images.githubusercontent.com/30624076/186174493-e8477e12-065c-487e-96c1-2704c374ff2a.png)

- オニオンアーキテクチャとは

  - クリーンアーキテクチャの具体化の一つ。外側のインフラ層から最内のドメインモデル層への１方向の依存をすることで変更や追加実装に強いパターンとなっている。

- ドメインモデル層
  - どこにも依存しない
  - データ構造などを管理する
- ドメインサービス層
  - ドメインモデルをオブジェクトとして表現すると無理のあるものを実装する層
- アプリケーションサービス層
  - ビジネスロジック(ユースケース)を管理する層
- インフラ層
  - DB などの外部ミドルウェアとの接続を行う層
- UI 層
  - ユーザ側との IO 部分(JSON を整形して返すなど)を実装する層

## ドメインモデル層が独立するメリット

- 他の層に依存しないことで、ドメインモデルの変更が容易になり、可読性も高まる
  - DB などドメイン以外の要素に左右されなくなる

## 層をまたいだ依存はインターフェースに対する依存のみにするメリット

- 具体ではなく抽象に依存することで、変更に強くなる(容易になる)メリットがある

## 依存性の逆転がオニオンアーキテクチャにどう使われているか

- ドメインモデルを中心に置くため、ドメインモデルとインフラ層の依存関係を逆転させることに用いている

## アクセス制限をどこでやるか

- 所謂コントローラが UI 層に属するものであるならば、UI 層に実装したい
  - リクエスト段階でそのアクセスユーザに対するチェックをして弾きたいため
  - (ただこれは MVC 的な前提に依存している気がする・・)
- ドメイン層に実装するべきかもしれない
  - 上述の内容と一部関連するが、ユーザそれぞれに可不可が定義されるということは、それはつまりドメインの知識であるとも言える

## データベースを MySQL から PostgreSQL に変更する場合どこを変更する？

- インフラ層を修正すればいいはず
  - そのために間にインターフェースを噛ませているはずなので

# 2

- クリーンアーキテクチャと比較した場合のオニオンアーキテクチャのメリットをわかる範囲で解答してください

- ドメインサービス層に書くべきもの、アプリケーションサービス層に書くべきものの違いを簡単に説明してください

- UI 層がドメイン層の処理を直接呼び出す場合、どのような問題を孕んでいるでしょうか？
